<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 9 Validación de supuestos | Modelos de Regresión</title>
  <meta name="description" content="Material para el curso Modelos no paramétricos y de regresión en la Facultad de Ciencias, Universidad Nacional Autónoma de México" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 9 Validación de supuestos | Modelos de Regresión" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Material para el curso Modelos no paramétricos y de regresión en la Facultad de Ciencias, Universidad Nacional Autónoma de México" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 9 Validación de supuestos | Modelos de Regresión" />
  
  <meta name="twitter:description" content="Material para el curso Modelos no paramétricos y de regresión en la Facultad de Ciencias, Universidad Nacional Autónoma de México" />
  

<meta name="author" content="Sofía Villers Gómez" />
<meta name="author" content="David Alberto Mateos Montes de Oca" />
<meta name="author" content="Dulce María Reyes Varela" />
<meta name="author" content="Carlos Fernando Vásquez Guerra" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="pruebas-de-hipótesis-1.html"/>
<link rel="next" href="apéndice.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos no paramétricos y de Regresión</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefacio</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#objetivos"><i class="fa fa-check"></i>Objetivos</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#licencia"><i class="fa fa-check"></i>Licencia</a></li>
</ul></li>
<li class="part"><span><b>I Introduccion</b></span></li>
<li class="chapter" data-level="" data-path="modelos-lineales.html"><a href="modelos-lineales.html"><i class="fa fa-check"></i>Modelos lineales</a>
<ul>
<li class="chapter" data-level="" data-path="modelos-lineales.html"><a href="modelos-lineales.html#principios-de-la-modelización-estadística"><i class="fa fa-check"></i>Principios de la modelización estadística</a></li>
<li class="chapter" data-level="" data-path="modelos-lineales.html"><a href="modelos-lineales.html#identificar-y-caracterizar-variables"><i class="fa fa-check"></i>Identificar y Caracterizar Variables</a></li>
<li class="chapter" data-level="" data-path="modelos-lineales.html"><a href="modelos-lineales.html#tipos-de-variables-y-tipo-de-modelo"><i class="fa fa-check"></i>Tipos de variables y tipo de modelo</a>
<ul>
<li class="chapter" data-level="" data-path="modelos-lineales.html"><a href="modelos-lineales.html#en-función-de-las-variables-explicativas"><i class="fa fa-check"></i>En función de las variables explicativas</a></li>
<li class="chapter" data-level="" data-path="modelos-lineales.html"><a href="modelos-lineales.html#en-función-de-la-variable-respuesta"><i class="fa fa-check"></i>En función de la variable respuesta</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="modelos-lineales.html"><a href="modelos-lineales.html#el-modelo-lineal-general"><i class="fa fa-check"></i>El modelo lineal general</a></li>
</ul></li>
<li class="part"><span><b>II Regresión Lineal Simple</b></span></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i>Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#objetivos-del-análisis-de-regresión"><i class="fa fa-check"></i>Objetivos del análisis de regresión</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#el-algorítmo-de-regresión-lineal"><i class="fa fa-check"></i>El algorítmo de regresión lineal</a></li>
<li class="chapter" data-level="" data-path="introducción.html"><a href="introducción.html#regresión-lineal-simple"><i class="fa fa-check"></i>Regresión lineal simple</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="modelo-con-intercepto.html"><a href="modelo-con-intercepto.html"><i class="fa fa-check"></i><b>1</b> Modelo con intercepto</a>
<ul>
<li class="chapter" data-level="1.1" data-path="modelo-con-intercepto.html"><a href="modelo-con-intercepto.html#estimación-por-mínimos-cuadrados-de-los-parámetros-del-modelo"><i class="fa fa-check"></i><b>1.1</b> Estimación por mínimos cuadrados de los parámetros del modelo</a></li>
<li class="chapter" data-level="1.2" data-path="modelo-con-intercepto.html"><a href="modelo-con-intercepto.html#propiedades-de-los-estimadores"><i class="fa fa-check"></i><b>1.2</b> Propiedades de los estimadores</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="modelo-sin-intercepto.html"><a href="modelo-sin-intercepto.html"><i class="fa fa-check"></i><b>2</b> Modelo sin intercepto</a>
<ul>
<li class="chapter" data-level="2.1" data-path="modelo-sin-intercepto.html"><a href="modelo-sin-intercepto.html#estimación-por-mínimos-cuadrados-de-los-parámetros-del-modelo-1"><i class="fa fa-check"></i><b>2.1</b> Estimación por mínimos cuadrados de los parámetros del modelo</a></li>
<li class="chapter" data-level="2.2" data-path="modelo-sin-intercepto.html"><a href="modelo-sin-intercepto.html#propiedades-de-los-estimadores-1"><i class="fa fa-check"></i><b>2.2</b> Propiedades de los estimadores</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="modelo-sin-intercepto.html"><a href="modelo-sin-intercepto.html#ejemplo-en-r-studio"><i class="fa fa-check"></i><b>2.2.1</b> Ejemplo en R-Studio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>3</b> Intervalos de confianza</a>
<ul>
<li class="chapter" data-level="3.1" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#intervalo-para-beta_0"><i class="fa fa-check"></i><b>3.1</b> Intervalo para <span class="math inline">\(\beta_{0}\)</span></a></li>
<li class="chapter" data-level="3.2" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#intervalo-para-beta_1"><i class="fa fa-check"></i><b>3.2</b> Intervalo para <span class="math inline">\(\beta_{1}\)</span></a></li>
<li class="chapter" data-level="3.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#intervalo-para-sigma2"><i class="fa fa-check"></i><b>3.3</b> Intervalo para <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="3.4" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#intervalo-para-el-valor-esperado-y"><i class="fa fa-check"></i><b>3.4</b> Intervalo para el valor esperado <span class="math inline">\(y\)</span></a></li>
<li class="chapter" data-level="3.5" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#intervalo-de-predicción"><i class="fa fa-check"></i><b>3.5</b> Intervalo de predicción</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#ejemplo"><i class="fa fa-check"></i><b>3.5.1</b> Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html"><i class="fa fa-check"></i><b>4</b> Pruebas de hipótesis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#pruebas-para-beta_0"><i class="fa fa-check"></i><b>4.1</b> Pruebas para <span class="math inline">\(\beta_{0}\)</span></a></li>
<li class="chapter" data-level="4.2" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-para-beta_1"><i class="fa fa-check"></i><b>4.2</b> Prueba para <span class="math inline">\(\beta_{1}\)</span></a></li>
<li class="chapter" data-level="4.3" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#prueba-para-sigma2"><i class="fa fa-check"></i><b>4.3</b> Prueba para <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="4.4" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#análisis-de-la-varianza-anova"><i class="fa fa-check"></i><b>4.4</b> Análisis de la varianza (ANOVA)</a></li>
<li class="chapter" data-level="4.5" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#coeficiente-de-determinación"><i class="fa fa-check"></i><b>4.5</b> Coeficiente de determinación</a></li>
<li class="chapter" data-level="4.6" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#propiedades-de-r2"><i class="fa fa-check"></i><b>4.6</b> Propiedades de <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="4.7" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#relación-r2-y-la-correlación-de-pearson"><i class="fa fa-check"></i><b>4.7</b> Relación <span class="math inline">\(R^2\)</span> y la correlación de Pearson</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="pruebas-de-hipótesis.html"><a href="pruebas-de-hipótesis.html#ejemplo-1"><i class="fa fa-check"></i><b>4.7.1</b> Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html"><i class="fa fa-check"></i><b>5</b> Validación de supuestos</a>
<ul>
<li class="chapter" data-level="5.1" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html#análisis-de-residuales"><i class="fa fa-check"></i><b>5.1</b> Análisis de residuales</a></li>
<li class="chapter" data-level="5.2" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html#supuesto-de-normalidad"><i class="fa fa-check"></i><b>5.2</b> Supuesto de normalidad</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html#validación-del-supuesto-de-normalidad"><i class="fa fa-check"></i><b>5.2.1</b> Validación del supuesto de normalidad</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html#supuesto-de-linealidad"><i class="fa fa-check"></i><b>5.3</b> Supuesto de linealidad</a></li>
<li class="chapter" data-level="5.4" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html#supuesto-de-homocedasticidad"><i class="fa fa-check"></i><b>5.4</b> Supuesto de homocedasticidad</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html#prueba-de-breusch-pagan"><i class="fa fa-check"></i><b>5.4.1</b> Prueba de Breusch-Pagan</a></li>
<li class="chapter" data-level="5.4.2" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html#prueba-de-white"><i class="fa fa-check"></i><b>5.4.2</b> Prueba de White</a></li>
<li class="chapter" data-level="5.4.3" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html#ejemplo-2"><i class="fa fa-check"></i><b>5.4.3</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html#valores-outlier-e-influyentes"><i class="fa fa-check"></i><b>5.5</b> Valores outlier e influyentes</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html#valores-outlier"><i class="fa fa-check"></i><b>5.5.1</b> Valores outlier</a></li>
<li class="chapter" data-level="5.5.2" data-path="validación-de-supuestos.html"><a href="validación-de-supuestos.html#valores-influentes"><i class="fa fa-check"></i><b>5.5.2</b> Valores influentes</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Modelo de regresión lineal múltiple</b></span></li>
<li class="chapter" data-level="" data-path="introducción-1.html"><a href="introducción-1.html"><i class="fa fa-check"></i>Introducción</a></li>
<li class="chapter" data-level="6" data-path="modelo.html"><a href="modelo.html"><i class="fa fa-check"></i><b>6</b> Modelo</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modelo.html"><a href="modelo.html#estimación-por-mínimos-cuadrados-de-los-parámetros-del-modelo-2"><i class="fa fa-check"></i><b>6.1</b> Estimación por mínimos cuadrados de los parámetros del modelo</a></li>
<li class="chapter" data-level="6.2" data-path="modelo.html"><a href="modelo.html#estimación-por-máxima-verosimilitud"><i class="fa fa-check"></i><b>6.2</b> Estimación por máxima verosimilitud</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="intervalos-de-confianza-1.html"><a href="intervalos-de-confianza-1.html"><i class="fa fa-check"></i><b>7</b> Intervalos de confianza</a>
<ul>
<li class="chapter" data-level="7.1" data-path="intervalos-de-confianza-1.html"><a href="intervalos-de-confianza-1.html#intervalo-para-beta_j"><i class="fa fa-check"></i><b>7.1</b> Intervalo para <span class="math inline">\(\beta_{j}\)</span></a></li>
<li class="chapter" data-level="7.2" data-path="intervalos-de-confianza-1.html"><a href="intervalos-de-confianza-1.html#intervalo-para-sigma2-1"><i class="fa fa-check"></i><b>7.2</b> Intervalo para <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="7.3" data-path="intervalos-de-confianza-1.html"><a href="intervalos-de-confianza-1.html#intervalos-de-la-respuesta-media"><i class="fa fa-check"></i><b>7.3</b> Intervalos de la respuesta media</a></li>
<li class="chapter" data-level="7.4" data-path="intervalos-de-confianza-1.html"><a href="intervalos-de-confianza-1.html#intervalos-de-predicción"><i class="fa fa-check"></i><b>7.4</b> Intervalos de predicción</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="pruebas-de-hipótesis-1.html"><a href="pruebas-de-hipótesis-1.html"><i class="fa fa-check"></i><b>8</b> Pruebas de hipótesis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="pruebas-de-hipótesis-1.html"><a href="pruebas-de-hipótesis-1.html#región-de-rechazo-para-beta_j"><i class="fa fa-check"></i><b>8.1</b> Región de rechazo para <span class="math inline">\(\beta_{j}\)</span></a></li>
<li class="chapter" data-level="8.2" data-path="pruebas-de-hipótesis-1.html"><a href="pruebas-de-hipótesis-1.html#prueba-para-sigma2-1"><i class="fa fa-check"></i><b>8.2</b> Prueba para <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="8.3" data-path="pruebas-de-hipótesis-1.html"><a href="pruebas-de-hipótesis-1.html#análisis-de-la-varianza-anova-1"><i class="fa fa-check"></i><b>8.3</b> Análisis de la varianza (ANOVA)</a></li>
<li class="chapter" data-level="8.4" data-path="pruebas-de-hipótesis-1.html"><a href="pruebas-de-hipótesis-1.html#coeficiente-de-determinación-2"><i class="fa fa-check"></i><b>8.4</b> Coeficiente de determinación</a></li>
<li class="chapter" data-level="8.5" data-path="pruebas-de-hipótesis-1.html"><a href="pruebas-de-hipótesis-1.html#r2-ajustado"><i class="fa fa-check"></i><b>8.5</b> <span class="math inline">\(R^2\)</span> ajustado</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="validación-de-supuestos-1.html"><a href="validación-de-supuestos-1.html"><i class="fa fa-check"></i><b>9</b> Validación de supuestos</a>
<ul>
<li class="chapter" data-level="9.1" data-path="validación-de-supuestos-1.html"><a href="validación-de-supuestos-1.html#supuesto-de-multicolinealidad"><i class="fa fa-check"></i><b>9.1</b> Supuesto de multicolinealidad</a></li>
<li class="chapter" data-level="9.2" data-path="validación-de-supuestos-1.html"><a href="validación-de-supuestos-1.html#detección-de-multicolinealidad"><i class="fa fa-check"></i><b>9.2</b> Detección de multicolinealidad</a></li>
<li class="chapter" data-level="9.3" data-path="validación-de-supuestos-1.html"><a href="validación-de-supuestos-1.html#ejemplo-3"><i class="fa fa-check"></i><b>9.3</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="apéndice.html"><a href="apéndice.html"><i class="fa fa-check"></i><b>10</b> Apéndice</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Hecho con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos de Regresión</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="validación-de-supuestos-1" class="section level1" number="9">
<h1><span class="header-section-number">Capítulo 9</span> Validación de supuestos</h1>
<p>Como vimos anteriormente, debemos validar los supuestos del modelo de regresión lineal múltiple:</p>
<ul>
<li><p>Supuesto de normalidad</p></li>
<li><p>Supuesto de linealidad</p></li>
<li><p>Supuesto de homocedasticidad</p></li>
<li><p>Valores outlier e influyentes</p></li>
<li><p>Supuesto de multicolinealidad</p></li>
</ul>
<p>Los primeros enlistados ya se vieron en la sección anterior, lo que vamos a introducir ahora es el supuesto de multicolinealidad.</p>
<div id="supuesto-de-multicolinealidad" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Supuesto de multicolinealidad</h2>
<p>Se dice que el ajuste del modelo lineal sobre una muestra tiene problemas de multicolinealidad cuando hay una correlación alta entre dos o más variables explicativas, consecuencia de que una variable regresora es linealmente dependiente a alguna o algunas de las demás variables de la matriz diseño <span class="math inline">\(X\)</span>.</p>
<p>Un modelo de regresión lineal con ésta característica provoca un error en la estimación de los parámetros <span class="math inline">\(\underline{\beta}\)</span>, ya que al tener variables linealmente dependientes el determinante <span class="math inline">\(\mid X&#39;X \mid \ \rightarrow 0\)</span>, lo cual provoca que la inversa <span class="math inline">\((X&#39;X)^{-1} \rightarrow \infty\)</span>.
Esto provoca el cálculo erróneo de los parámetros, ya que el producto matricial de <span class="math inline">\(\underline{\hat{\beta}}=(X&#39;X)^{-1}X&#39;\underline{Y}\)</span> no puede ser aproximado de la mejor manera.</p>
</div>
<div id="detección-de-multicolinealidad" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Detección de multicolinealidad</h2>
<p>Debido al problema de estimación de los parámetros <span class="math inline">\(\underline{\beta}\)</span> que ocasiona un modelo con multicolinealidad, se realizan validaciones con la finalidad de tener evidencia suficiente para asumir si el modelo posee o no el problema de dependencia lineal de las variables explicativas.</p>
<p>El método más adecuado para efectuar ésta validación, es encontrar en la matriz de diseño <span class="math inline">\(X\)</span> variables regresoras linealmente dependendientes a través de operaciones matriciales elementales, sin embargo, este procedimiento es tardado conforme el tamaño de la muestra es mayor, además de que computacionalmente el procedimiento no es óptimo, es por ello que se desarrollan diferentes métodos para conocer si el modelo presenta multicolinealidad.</p>
<p><strong>A través de correlaciones</strong></p>
<p>El primer método para detectar la dependencia lineal es analizar el coeficiente de correlación de las variables, ya que si el modelo posee variables altamente correlacionadas entre sí, es probable que el ajuste lineal presente problemas de multicolinealidad debido a la relación estrecha de éstas variables, una desventaja de éste método es que analiza a través de la matriz de correlaciones de una variable comparada con otra, sin embargo, puede existir una baja correlación entre variables analizándolas una a una pero al analizarlas de dos en dos, o de tres en tres, etcétera, puede encontrarse una alta correlación.</p>
<p>Para analizar de mejor forma la información, se obtiene el determinante de la matriz de correlaciones, si este es muy cercano a cero podría proporcionar indicios de problemas de multicolinealidad, debido a que si hay dos variables que son linealmente dependientes el determinante de la matriz de correlaciones tenderá a cero. Sin embargo, depende del prejuicio del investigador a partir de qué cifra debe ser considerada una cantidad mínima.</p>
<p><strong>A través del índice <span class="math inline">\(\kappa\)</span></strong></p>
<p>En 1960, Jacob Cohen, presentó el método del coeficiente kappa. El coeficiente kappa o simplemente <span class="math inline">\(\kappa\)</span> se basa en el análisis de los eigenvalores <span class="math inline">\(\lambda_{1},\lambda_{2},\ldots,\lambda_{k}\)</span> de la matriz <span class="math inline">\((X&#39;X),\)</span> este procedimiento es llamado <span class="math inline">\(análisis \ del \ egeinsistema.\)</span></p>
<p>Debido a que <span class="math inline">\((X&#39;X)\)</span> es una matriz simétrica, el producto de la matriz diseño es igual a sus valores propios o eigenvalores. De esta manera el método propone observar la proporción del eigenvalor más grande respecto al más pequeño, si la proporción es pequeña, no hay problemas de multicolinealidad pues todos los valores propios son similares, sin embargo, proporciones altas indican gran variabilidad en los valores propios por lo que se tiene indicios de multicolinealidad.
De esta manera el coeficiente <span class="math inline">\(\kappa\)</span> es calculado como:</p>
<p><span class="math display">\[\kappa=\frac{\lambda_{max}}{\lambda_{min}}.\]</span></p>
</div>
<div id="ejemplo-3" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Ejemplo</h2>
<p>Se tiene información sobre las cajetillas vendidas y queremos saber que factores influyen en dichas ventas.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="validación-de-supuestos-1.html#cb60-1" aria-hidden="true" tabindex="-1"></a>cigarros<span class="ot">=</span><span class="fu">read.table</span>(<span class="st">&quot;datos cigarros.csv&quot;</span>,<span class="at">sep=</span><span class="st">&quot;,&quot;</span>,<span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb60-2"><a href="validación-de-supuestos-1.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(cigarros)</span></code></pre></div>
<p>Lo primero que hay que hacer es identificar las variables que hay en la base y realizar diagramas de dispersión para tener una idea de que tipo de relación existe entre las variables.</p>
<pre><code>  ESTADO  SCIG  AGE   ED PERFEM PRICE
1      1  89.8 27.0 41.3   51.7  42.7
2      2 121.3 22.9 66.7   45.7  41.8
3      3 115.2 26.3 58.1   50.8  38.5
4      4 100.3 29.1 39.9   51.5  38.8
5      5 123.0 28.1 62.6   50.8  39.7
6      6 124.8 26.2 63.9   50.7  31.1</code></pre>
<p><span class="math inline">\(\textbf{y}=\textbf{SCIG} \ : \ \mbox{Cajetillas de cigarro vendidas}\)</span></p>
<p><span class="math inline">\(\textbf{x}_1=\textbf{AGE} \ : \ \mbox{Edad promedio}\)</span></p>
<p><span class="math inline">\(\textbf{x}_2=\textbf{ED} \ : \ \mbox{Porcentaje de personas con más de 25 años}\)</span></p>
<p><span class="math inline">\(\textbf{x}_3=\textbf{PERFEM} \ : \ \mbox{Porcentaje de mujeres}\)</span></p>
<p><span class="math inline">\(\textbf{x}_4=\textbf{PRICE} \ : \ \mbox{Precio}\)</span></p>
<pre><code>     ESTADO           SCIG            AGE              ED            PERFEM          PRICE      
 Min.   : 1.00   Min.   : 65.5   Min.   :22.90   Min.   :37.80   Min.   :45.70   Min.   :29.00  
 1st Qu.:14.75   1st Qu.:105.9   1st Qu.:26.48   1st Qu.:47.80   1st Qu.:50.67   1st Qu.:34.62  
 Median :28.50   Median :117.5   Median :27.30   Median :53.90   Median :51.00   Median :38.90  
 Mean   :28.50   Mean   :120.9   Mean   :27.50   Mean   :53.23   Mean   :50.93   Mean   :38.01  
 3rd Qu.:42.25   3rd Qu.:124.4   3rd Qu.:28.73   3rd Qu.:59.23   3rd Qu.:51.50   3rd Qu.:41.33  
 Max.   :56.00   Max.   :265.7   Max.   :32.30   Max.   :67.30   Max.   :53.50   Max.   :45.50  </code></pre>
<p><strong>Ajuste de un modelo de RLM</strong></p>
<p>Ajustaremos un modelo de RLM considerando lo siguiente:</p>
<ul>
<li><p>Emplearemos el método <span class="math inline">\(\textbf{backward}.\)</span></p></li>
<li><p>El criterio de selección del <span class="math inline">\(mejor \ modelo\)</span> estará basado en el <span class="math inline">\(\textbf{AIC}\)</span></p></li>
</ul>
<p>El método <strong>backward</strong> (eliminación hacia atrás) consiste en comenzar con un modelo que incluya las <span class="math inline">\(k\)</span> variables regresoras y luego ir eliminando varible por variable de acuerdo a cierto criterio.</p>
<p>El <strong>AIC</strong> (Criterio de información de Akaike) es una medida de la calidad de un modelo estadístico, considera la <span class="math inline">\(bondad \ de \ ajuste\)</span> del modelo y su complejidad.</p>
<p><span class="math display">\[AIC=-2log(L) +2* n_{parámetros}\]</span>
El mejor modelo es aquel que tenga un <span class="math inline">\(\textbf{AIC}\)</span> pequeño.</p>
<p><strong>Primer Paso: Relación entre Variables</strong></p>
<p>Primero haremos las gráficas de dispersión correspondientes para ver el comportamiento de los datos.</p>
<p>Diagramas de dispersion por parejas: Primero juntamos todas las variables explicativas y la dependiente en un solo objeto para hacer los diagramas de dispersion para cada pareja</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="validación-de-supuestos-1.html#cb63-1" aria-hidden="true" tabindex="-1"></a>cigarrosvars<span class="ot">=</span><span class="fu">data.frame</span>(cigarros<span class="sc">$</span>SCIG,cigarros<span class="sc">$</span>AGE,cigarros<span class="sc">$</span>ED,cigarros<span class="sc">$</span>PERFEM,cigarros<span class="sc">$</span>PRICE)</span>
<span id="cb63-2"><a href="validación-de-supuestos-1.html#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(cigarrosvars)</span></code></pre></div>
<pre><code>                cigarros.SCIG cigarros.AGE cigarros.ED cigarros.PERFEM cigarros.PRICE
cigarros.SCIG      1.00000000    0.2150081  0.05494773      0.14296083    -0.30696253
cigarros.AGE       0.21500813    1.0000000 -0.12564933      0.55508730     0.26605603
cigarros.ED        0.05494773   -0.1256493  1.00000000     -0.43495874     0.04667213
cigarros.PERFEM    0.14296083    0.5550873 -0.43495874      1.00000000     0.04906057
cigarros.PRICE    -0.30696253    0.2660560  0.04667213      0.04906057     1.00000000</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="validación-de-supuestos-1.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(cigarrosvars,<span class="at">main=</span><span class="st">&quot;Matriz de dispersion&quot;</span>,<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Cajetillas vendidas&quot;</span>, <span class="st">&quot;Edad promedio&quot;</span>, <span class="st">&quot;Porcentaje con mas de 25&quot;</span>, <span class="st">&quot;Porcentaje mujeres&quot;</span>, <span class="st">&quot;Precio promedio&quot;</span>),<span class="at">pch=</span><span class="dv">21</span>,<span class="at">bg=</span><span class="st">&quot;deeppink4&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-62-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>A simple vista “no estamos apreciando toda la información,” haremos gráficos dos a dos:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="validación-de-supuestos-1.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cigarros<span class="sc">$</span>AGE,cigarros<span class="sc">$</span>SCIG,<span class="at">type =</span> <span class="st">&quot;p&quot;</span>,<span class="at">col=</span><span class="st">&quot;deeppink4&quot;</span>,<span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb66-2"><a href="validación-de-supuestos-1.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;Edad promedio&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Cajetillas vendidas&quot;</span>,</span>
<span id="cb66-3"><a href="validación-de-supuestos-1.html#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span> <span class="st">&quot;Relación entre la edad promedio y las cajetillas vendidas&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-63-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="validación-de-supuestos-1.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cigarros<span class="sc">$</span>ED,cigarros<span class="sc">$</span>SCIG,<span class="at">type =</span> <span class="st">&quot;p&quot;</span>,<span class="at">col=</span><span class="st">&quot;deeppink4&quot;</span>,<span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb67-2"><a href="validación-de-supuestos-1.html#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;Porcentaje con más de 25&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Cajetillas vendidas&quot;</span>,</span>
<span id="cb67-3"><a href="validación-de-supuestos-1.html#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span> <span class="st">&quot;Relación entre el porcentaje con más de 25 y las cajetillas vendidas&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-64-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="validación-de-supuestos-1.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cigarros<span class="sc">$</span>PERFEM,cigarros<span class="sc">$</span>SCIG,<span class="at">type =</span> <span class="st">&quot;p&quot;</span>,<span class="at">col=</span><span class="st">&quot;deeppink4&quot;</span>,<span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb68-2"><a href="validación-de-supuestos-1.html#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;Porcentaje de mujeres&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Cajetillas vendidas&quot;</span>,</span>
<span id="cb68-3"><a href="validación-de-supuestos-1.html#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span> <span class="st">&quot;Relación entre el porcentaje de mujeres y las cajetillas vendidas&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-65-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="validación-de-supuestos-1.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cigarros<span class="sc">$</span>PRICE,cigarros<span class="sc">$</span>SCIG,<span class="at">type =</span> <span class="st">&quot;p&quot;</span>,<span class="at">col=</span><span class="st">&quot;deeppink4&quot;</span>,<span class="at">pch=</span><span class="dv">16</span>,</span>
<span id="cb69-2"><a href="validación-de-supuestos-1.html#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="at">xlab=</span><span class="st">&quot;Precio&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;Cajetillas vendidas&quot;</span>,</span>
<span id="cb69-3"><a href="validación-de-supuestos-1.html#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="at">main=</span> <span class="st">&quot;Relación entre el precio y las cajetillas vendidas&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-66-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Observemos que tanto la variable de promedio de más de 25 y las cajetillas vendidas muestran una relación, al igual que la variable precio.</p>
<p>Veamos ahora la correlación entre las variables:</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="validación-de-supuestos-1.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(cigarros)</span></code></pre></div>
<pre><code>             ESTADO        SCIG         AGE          ED       PERFEM       PRICE
ESTADO  1.000000000 -0.11088992  0.05535895 -0.05138058 -0.002021391 -0.05523295
SCIG   -0.110889919  1.00000000  0.21500813  0.05494773  0.142960829 -0.30696253
AGE     0.055358955  0.21500813  1.00000000 -0.12564933  0.555087298  0.26605603
ED     -0.051380577  0.05494773 -0.12564933  1.00000000 -0.434958738  0.04667213
PERFEM -0.002021391  0.14296083  0.55508730 -0.43495874  1.000000000  0.04906057
PRICE  -0.055232952 -0.30696253  0.26605603  0.04667213  0.049060568  1.00000000</code></pre>
<p>Las correlaciones entre las variables que no son las cajetillas vendidas no son “altas” por lo que en principio no parece haber problema de considerar todas las variables dentro del modelo.</p>
<p><strong>Segundo Paso: Generación de Modelos y Elección del Mejor Modelo</strong></p>
<p>Emplearemos comandos de R:</p>
<p>Empezaremos con el modelo inicial, le llamamos así ya que es el modelo más grande que podemos suponer, ya que el modelo explica las cajetillas vendidas en función de las otras 4 variables:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="validación-de-supuestos-1.html#cb72-1" aria-hidden="true" tabindex="-1"></a>modeloini<span class="ot">=</span><span class="fu">lm</span>(SCIG<span class="sc">~</span>AGE<span class="sc">+</span>ED<span class="sc">+</span>PERFEM<span class="sc">+</span>PRICE, <span class="at">data=</span>cigarros) </span>
<span id="cb72-2"><a href="validación-de-supuestos-1.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modeloini)</span></code></pre></div>
<pre><code>
Call:
lm(formula = SCIG ~ AGE + ED + PERFEM + PRICE, data = cigarros)

Residuals:
    Min      1Q  Median      3Q     Max 
-43.242 -13.160  -5.053   3.166 128.099 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  -8.0742   231.4589  -0.035  0.97231   
AGE           5.2521     2.6733   1.965  0.05492 . 
ED            0.5115     0.5389   0.949  0.34699   
PERFEM        1.3716     4.8326   0.284  0.77770   
PRICE        -2.9599     0.9713  -3.047  0.00365 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 28.62 on 51 degrees of freedom
Multiple R-squared:  0.2034,    Adjusted R-squared:  0.1409 
F-statistic: 3.255 on 4 and 51 DF,  p-value: 0.01878</code></pre>
<p>De este primer modelo dado que las pruebas de hipótesis para cada <span class="math inline">\(\beta_{i}\)</span> nos dicen que la única variable significativa es <span class="math inline">\(\beta_{4}\)</span> que es para la variable Precio. Y hasta el momento tiene sentido esto.</p>
<p>Ahora si, emplearemos el método backward con el criterio AIC.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="validación-de-supuestos-1.html#cb74-1" aria-hidden="true" tabindex="-1"></a>modelo_backward_AIC<span class="ot">=</span><span class="fu">stepAIC</span>(modeloini,<span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>)</span></code></pre></div>
<pre><code>Start:  AIC=380.41
SCIG ~ AGE + ED + PERFEM + PRICE

         Df Sum of Sq   RSS    AIC
- PERFEM  1      66.0 41828 378.49
- ED      1     737.8 42500 379.39
&lt;none&gt;                41762 380.41
- AGE     1    3160.6 44923 382.49
- PRICE   1    7604.1 49366 387.77

Step:  AIC=378.49
SCIG ~ AGE + ED + PRICE

        Df Sum of Sq   RSS    AIC
- ED     1     689.2 42517 377.41
&lt;none&gt;               41828 378.49
- AGE    1    5402.7 47231 383.30
- PRICE  1    7813.1 49641 386.08

Step:  AIC=377.41
SCIG ~ AGE + PRICE

        Df Sum of Sq   RSS    AIC
&lt;none&gt;               42517 377.41
- AGE    1    4965.6 47483 381.60
- PRICE  1    7481.7 49999 384.49</code></pre>
<p>Ahora observemos el mejor modelo, de acuerdo a lo arrojado en <strong>stepAIC()</strong>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="validación-de-supuestos-1.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_backward_AIC)</span></code></pre></div>
<pre><code>
Call:
lm(formula = SCIG ~ AGE + PRICE, data = cigarros)

Residuals:
    Min      1Q  Median      3Q     Max 
-35.828 -15.601  -6.451   3.807 130.691 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  83.4541    61.0443   1.367  0.17736   
AGE           5.3878     2.1656   2.488  0.01603 * 
PRICE        -2.9121     0.9536  -3.054  0.00353 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 28.32 on 53 degrees of freedom
Multiple R-squared:  0.1889,    Adjusted R-squared:  0.1583 
F-statistic: 6.174 on 2 and 53 DF,  p-value: 0.003889</code></pre>
<p>A través de la tablas ANOVA se tiene:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="validación-de-supuestos-1.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(modelo_backward_AIC)</span></code></pre></div>
<pre><code>Analysis of Variance Table

Response: SCIG
          Df Sum Sq Mean Sq F value   Pr(&gt;F)   
AGE        1   2423  2423.4  3.0209 0.088005 . 
PRICE      1   7482  7481.7  9.3264 0.003529 **
Residuals 53  42517   802.2                    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>De los resultados obtenidos podemos refinar el <span class="math inline">\(mejor \ modelo\)</span> obtenido:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="validación-de-supuestos-1.html#cb80-1" aria-hidden="true" tabindex="-1"></a>modelo_refinado<span class="ot">=</span><span class="fu">lm</span>(SCIG<span class="sc">~</span><span class="dv">0</span><span class="sc">+</span>AGE<span class="sc">+</span>PRICE,cigarros)</span>
<span id="cb80-2"><a href="validación-de-supuestos-1.html#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(modelo_refinado)</span></code></pre></div>
<pre><code>
Call:
lm(formula = SCIG ~ 0 + AGE + PRICE, data = cigarros)

Residuals:
    Min      1Q  Median      3Q     Max 
-30.841 -16.734  -5.385   4.999 131.509 

Coefficients:
      Estimate Std. Error t value Pr(&gt;|t|)    
AGE      7.809      1.257   6.214 7.73e-08 ***
PRICE   -2.477      0.906  -2.734  0.00845 ** 
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 28.55 on 54 degrees of freedom
Multiple R-squared:  0.9495,    Adjusted R-squared:  0.9476 
F-statistic: 507.6 on 2 and 54 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Entonces ya obtuvimos el mejor modelo, que está compuesto por:</p>
<p><span class="math display">\[\mbox{Cajetillas vendidas}= 7.809*\mbox{Edad promedio}-2.477*\mbox{Precio}\]</span>
Bueno todavía debemos validar los supuestos:</p>
<p><strong>Tercer Paso Validadción de Supuestos</strong></p>
<p>Siguiendo el orden de nuestros capítulos, para validar gráficamente la normalidad de los errores debemos graficar los errores contra los cuantiles de la distribución normal.Para ello aplicamos la función <strong>qqnorm</strong> y con <strong>qqline</strong> obtenemos la recta diagonal que nos servirá para ver que tan lejos o cerca de la distribución normal están cayendo los residuales.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="validación-de-supuestos-1.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">rstandard</span>(modelo_refinado),<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>),<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb82-2"><a href="validación-de-supuestos-1.html#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">rstandard</span>(modelo_refinado),<span class="at">distribution =</span> qnorm,<span class="at">col=</span><span class="st">&quot;deeppink4&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-73-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Podemos observar que la parte central de la distribución si se ajusta a una distribución normal, sin embargo, en los extremos los residuales ya no se comportan como una distribución normal.</p>
<p>Podemos aplicar la prueba de bondad de ajuste <strong>Lilliefors para normalidad</strong> vista en Bondad de Ajuste:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="validación-de-supuestos-1.html#cb83-1" aria-hidden="true" tabindex="-1"></a>nortest<span class="sc">::</span><span class="fu">lillie.test</span>(<span class="fu">rstandard</span>(modelo_refinado))</span></code></pre></div>
<pre><code>
    Lilliefors (Kolmogorov-Smirnov) normality test

data:  rstandard(modelo_refinado)
D = 0.23318, p-value = 4.065e-08</code></pre>
<p>Como el valor del <span class="math inline">\(p-value\)</span> es menor al nivel de significancia <span class="math inline">\(\alpha=0.05\)</span> entonces rechazamos <span class="math inline">\(H_{0}\)</span>, es decir nuestros residuales no tienen distribución normal.</p>
<p><strong>Supuesto de Linealidad</strong></p>
<p>Como se menciona en el capítulo, graficaremos los errores estandarizados contra los valores observados de la variable explicativa.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-75-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><img src="_main_files/figure-html/unnamed-chunk-76-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Para ambas variables, salvo por la posible presencia de algunos valores atípicos que salen de la franja horizontal <span class="math inline">\((-2,2)\)</span>, el resto de las observaciones parecen distribuirse como ruido blanco.</p>
<p><strong>Supuesto de Homocedasticidad</strong></p>
<p>Se dice que una muestra es homocedástica cuando la varianza es constante a lo largo de todas las observaciones, es decir, no varia conforme se presentan nuevas observaciones.</p>
<p><img src="_main_files/figure-html/unnamed-chunk-77-1.png" width="672" style="display: block; margin: auto;" /></p>
<ul>
<li>Si la varianza es constante entonces la gráfica fluctuaráentre el eje horizontal de manera simétrica, y sin seguir algún patrón, y se espera que la mayor parte de los errores estén contenidos en franjas horizontales delimitados por el eje entre -2 y 2. En éste ejemplo la dispersión regular de los residuales dentro de las Bandas superior e inferior y que no haya residuales que se alejen tanto de la Banda 0, indican varianza constante.</li>
</ul>
<p>Adicionalmente aplicaremos las pruebas vistas en el capítulo para tener certeza estadística de la validez del supuesto de homocedasticidad.</p>
<p><strong>Prueba White</strong></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="validación-de-supuestos-1.html#cb85-1" aria-hidden="true" tabindex="-1"></a>dataset<span class="ot">=</span><span class="fu">data.frame</span>(cigarros<span class="sc">$</span>AGE,cigarros<span class="sc">$</span>PRICE,cigarros<span class="sc">$</span>SCIG)</span>
<span id="cb85-2"><a href="validación-de-supuestos-1.html#cb85-2" aria-hidden="true" tabindex="-1"></a>mode1<span class="ot">=</span><span class="fu">VAR</span>(dataset,<span class="at">p=</span><span class="dv">1</span>)</span>
<span id="cb85-3"><a href="validación-de-supuestos-1.html#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co">#whites.htest(mode1)</span></span></code></pre></div>
<p>Por el <span class="math inline">\(p-value\)</span>, la hipótesis de homocedasticidad no se rechaza.</p>
<p><strong>Supuesto de Multicolinealidad</strong></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="validación-de-supuestos-1.html#cb86-1" aria-hidden="true" tabindex="-1"></a>X1<span class="ot">=</span><span class="fu">scale</span>(cigarros[,<span class="sc">-</span><span class="dv">5</span>])</span>
<span id="cb86-2"><a href="validación-de-supuestos-1.html#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="validación-de-supuestos-1.html#cb86-3" aria-hidden="true" tabindex="-1"></a>A<span class="ot">=</span><span class="fu">t</span>(X1)<span class="sc">%*%</span>X1</span>
<span id="cb86-4"><a href="validación-de-supuestos-1.html#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="validación-de-supuestos-1.html#cb86-5" aria-hidden="true" tabindex="-1"></a>kappa<span class="ot">=</span><span class="fu">max</span>(<span class="fu">eigen</span>(A)<span class="sc">$</span>values)<span class="sc">/</span><span class="fu">min</span>(<span class="fu">eigen</span>(A)<span class="sc">$</span>values)</span>
<span id="cb86-6"><a href="validación-de-supuestos-1.html#cb86-6" aria-hidden="true" tabindex="-1"></a>kappa</span></code></pre></div>
<pre><code>[1] 3.151592</code></pre>
<p>El coeficiente <span class="math inline">\(kappa\)</span> es de 3.15 por lo tanto no tenemos problemas de multicolinealidad.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="pruebas-de-hipótesis-1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="apéndice.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "github", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
